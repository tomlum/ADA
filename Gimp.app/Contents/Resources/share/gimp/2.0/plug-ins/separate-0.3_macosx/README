CMYK Separation plugin for The GIMP
(c) 2003-2005 - Alastair M. Robinson <blackfive@fakenhamweb.co.uk>
Released under the terms of the GNU General Public Licence V2.
See the file "COPYING" for full details.

Version 0.3

Please note:
This is unfinished and experimental software.  I have used it with success
for several months, but I don't guarantee that it will work for you!

You use this software entirely at your own risk, I cannot be held responsible
for any damages caused by the use or misuse of this software.


Introduction:
~~~~~~~~~~~~~
One thing preventing The GIMP from being useful in a pre-press environment
is the lack of support for the CMYK colour-space.  This plug-in goes some
small way towards rectifying the situation, using a trick with layers to fake
CMYK support.

The plugin is unfinished, but usable for its primary purpose, and since I'm
unlikely to have time to develop it further in the near future, I'm releasing
it as is.


What can it do?
~~~~~~~~~~~~~~~
* Convert an RGB image to individual CMYK layers, using specified source and
  destination Colour Profiles.

* Save such a collection of layers as a CMYK TIFF.

* Proof the CMYK image on the monitor.  (Performs an Absolute Colorimetric
  transform from the CMYK profile back to the RGB profile.)

* Perform a "duotone" separation on an RGB image, reducing it to just those
  colours achievable with red and black ink.  (This feature does *not* use
  colour-profiles!)


What can't it do?
~~~~~~~~~~~~~~~~~
* Load CMYK TIFFs into individual layers.  If you want to edit a CMYK image,
  save it in XCF format as well as CMYK TIFF, so the layers are preserved for
  future editing.

* Embed ICC profiles in the generated TIFF.

* Perform the "duotone" trick based on any colour other than red.


Requirements:
~~~~~~~~~~~~~
* The RGB -> CMYK conversion is performed with the truly excellent littlecms
  library, so you'll need that installed.
* LibTIFF is also used, but since The GIMP itself uses it, its unlikely to be
  missing!
* ICC profiles.
  I recommend that you download Adobe's free colour profiles; a Google search
  for Adobe ICC profiles will find them...


Installation (Linux):
~~~~~~~~~~~~~~~~~~~~~
To install the plugin globally, copy the "separate" file to:
  prefix/lib/gimp/1.2/plug-ins/
where prefix will be either /usr, /usr/local, or possibly even /usr/X11R6,
depending on where your Linux installation keeps its GIMP!  This needs to be
done as root.

You can also install the plugin for a single user, by copying the file to
  $HOME/.gimp-2.0/plug-ins/
(Replace 2.0 with your GIMP version!)
This, of course, doesn't require root privileges.

You can keep the colour profiles wherever you like, but unless you edit the
default paths in platform.h and recompile the plugin, or place them in the
default location, you'll have to locate them each time you use the plugin.

The default search path for colour profiles has changed with this version:
It now uses the same directory as CinePaint:
  /usr/share/color/icc/

To install the Adobe ICC profiles, unzip the AdobeICCProfiles.zip file, and
do the following as root:
  mkdir /usr/local/iccprofiles
  cp Adobe\ ICC\ Profiles/RGB\ Profiles/* /usr/share/color/icc/
  cp Adobe\ ICC\ Profiles/CMYK\ Profiles/* /usr/share/color/icc/

Finally, install the provided sRGB profile:
  cp separate/sRGB/sRGB\ Color\ Space\ Profile.icm /usr/share/color/icc/
  
The default profiles are:
RGB: sRGB Color Space Profile.icm  (included in the archive)
CMYK: USWebCoatedSWOP.icc  (from the Adobe profiles archive)


Installation (Windows):
~~~~~~~~~~~~~~~~~~~~~~~
Copy the plugin "separate.exe" and the "liblcms.dll" support library to:
  C:\Program Files\gimp\lib\gimp\1.2\plug-ins\

By default the plugin searches for colour profiles at:
  C:\Program Files\gimp\ColourProfiles
To install the Adobe ICC profiles:
* unzip the AdobeICCProfiles.zip file
* rename the Adobe ICC Profiles folder to ColourProfiles
* copy the provided sRGB profile to ColourProfiles\RGB Profiles
* move the ColourProfiles folder to c:\Program Files\gimp\


Installation (Mac OS X)
~~~~~~~~~~~~~~~~~~~~~~~

As root, copy the "separate" file into:
	MacGIMP.app/Contents/Resources/share/gimp/2.0/plug-ins/

You can also install the plugin for a single user, by copying the file to
  $HOME/.gimp-2.0/plug-ins/
(Replace 2.0 with your GIMP version!)
This, of course, doesn't require root privileges.

To install the Adobe ICC profiles, unzip the AdobeICCProfiles.zip file, and
do the following as root:
  mkdir /opt/local/iccprofiles
  cp Adobe\ ICC\ Profiles/RGB\ Profiles/* /opt/local/share/color/icc/
  cp Adobe\ ICC\ Profiles/CMYK\ Profiles/* /opt/local/share/color/icc/

Finally, install the provided sRGB profile:
  cp separate/sRGB/sRGB\ Color\ Space\ Profile.icm /opt/local/share/color/icc/

The default profiles are:
RGB: sRGB Color Space Profile.icm
CMYK: USWebCoatedSWOP.icc



Separating an image:
~~~~~~~~~~~~~~~~~~~~
To convert an RGB image to CMYK format, bring up the right-button menu, and go
to "Image->"  If the plugin in installed correctly, there will be a new menu,
"Separate".  From this new menu, select "Separate (normal)"; you will be
prompted to select an RGB source profile, and a CMYK destination profile.
If you have installed the Adobe and sRGB profiles as per the above
instructions, you can just accept the defaults for testing, otherwise you'll
have to locate the profiles manually.

A new image will be created with four greyscale layers, named "C", "M", "Y",
and "K".

If you have loads of memory to spare, you can use the "Separate (colour)"
option; this will perform the same operation, but the new image will contain
five layers: The first, "Background" will be white, and the other four will
be solid Cyan, Magenta, Yellow and Black, with the separated image data in
layer masks.  In addition, the layer modes for the four colours will be set
to "Darken Only". 
This gives a rough reconstruction of the colours, and is the next best thing
to a true CMYK painting mode, since you can paint on the layer masks, and see
the results in realtime.

This version of the plugin uses more realistic CMYK primary colour for the
CMYK simulation, which should greatly lessen the over-saturated look that
used to result.


Saving:
~~~~~~~
To save a CMYK TIFF for use in a DTP program, bring up the right-mouse-button
menu, and select "Image->Separate->Save...".  Please note that saving an image
this way won't clear the image's modified flag, so when closing, you'll be
warned that the image hasn't been saved.  This won't be fixed until the plugin
is capable of loading CMYK images. Until then, if you need to edit the CMYK
image in the future, you need to save it off in XCF format, to preserve the
layers.


Duotone:
~~~~~~~~
This is a little bonus, included simply because I needed it at work.
It reduces the colours in the image to those available just using red and
black ink, then creates a pseudo-CMYK image, with just Backgroud, K and M
layers.
The resulting image can be saved in the same way as a real CMYK image, but
the "red" data will occupy the "magenta" channel of the resulting TIFF.
